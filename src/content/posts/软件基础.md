---
title: 'è½¯ä»¶åŸºç¡€ï¼šå½¢å¼éªŒè¯'
description: 'ä¸€ç¯‡å…³äºå½¢å¼éªŒè¯ã€Coq å®‰è£…å’Œé…ç½®çš„å…¥é—¨æŒ‡å—ï¼Œæ¶µç›–äº† opam å’Œ VsCoq çš„è¯¦ç»†æ­¥éª¤ã€‚'
pubDate: 2025-07-30
tags: ['å½¢å¼éªŒè¯', 'Coq',  'æ•™ç¨‹', 'ç¯å¢ƒé…ç½®']
author: 'Ating'
heroImage: 'software-found.webp'
ogImage: 'software-found.webp'
heroImageAspectRatio: '16/9'
recommend: true
---

å½¢å¼éªŒè¯æ˜¯ä½¿ç”¨æ•°å­¦æ–¹æ³•ä¸¥æ ¼è¯æ˜ç¨‹åºæˆ–ç³»ç»Ÿæ­£ç¡®æ€§çš„æŠ€æœ¯ã€‚ä¸åŒäºæµ‹è¯•ï¼ˆåªèƒ½å‘ç°å­˜åœ¨çš„é”™è¯¯ï¼‰ï¼Œå½¢å¼éªŒè¯å¯ä»¥è¯æ˜é”™è¯¯çš„ä¸å­˜åœ¨ã€‚

å½¢å¼éªŒè¯çš„ç›®æ ‡æ˜¯ï¼Œå°†ä¸€æ®µç¨‹åºçš„åŠŸèƒ½ç”¨å¦ä¸€æ®µç¨‹åºè¡¨è¾¾ï¼Œå¹¶ä¸”å†ç”¨å¦ä¸€æ®µç¨‹åºæ¥è¡¨ç¤ºè¯¥ç¨‹åºç¬¦åˆç»™å®šçš„åŠŸèƒ½è¦æ±‚ã€‚

## Coqå®‰è£…

Coq æä¾›äº†Linuxã€Windowså’ŒMacOS åœ¨å†…çš„å¤šç³»ç»Ÿå®‰è£…ã€‚ä½†æ˜¯ç”±äºåšä¸»ç”µè„‘é—®é¢˜æˆ–è€…å…¶ä»–ä¸€äº›åŸå› ï¼Œå¹¶æ²¡æœ‰æˆåŠŸå®‰è£…å…¶Windowsç¯å¢ƒï¼Œåªèƒ½æƒ³åŠæ³•åœ¨WSL2ä¸­ï¼Œå³Linuxä¸­ä½¿ç”¨COQã€‚
ä¹Ÿå¹¸äºä¹‹å‰æœ‰è¿‡WSL2+VsCodeç»éªŒï¼Œä¸ç„¶åˆå°‘ä¸äº†ä¸€ç•ªæŠ˜è…¾ã€‚

### å®‰è£…opam

Linux å’ŒMacOs å¯ä»¥ä½¿ç”¨ opam å®˜ç½‘æä¾›çš„è„šæœ¬ä¸€é”®å®‰è£…ã€‚

```bash title='Shell Command'
bash -c "sh <(curl -fsSL https://opam.ocaml.org/install.sh)"
```

æ³¨æ„ï¼š è„šæœ¬ä¼šå°† opam é»˜è®¤å®‰è£…åˆ°Â `/usr/local/bin`ï¼Œå¦‚ä¸ä¿®æ”¹è¯·ç¡®ä¿å½“å‰ç”¨æˆ·è¯¥è·¯å¾„æœ‰è¯»å†™æƒé™`(sudo)`ã€‚

å®‰è£…å®Œæˆåå¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤ç¡®è®¤æ˜¯å¦å®‰è£…æˆåŠŸã€‚å¦‚æœæˆåŠŸå°†è¿”å› opamçš„ç‰ˆæœ¬å·ï¼Œä¸ºç¡®ä¿Coq å®‰è£…æˆåŠŸï¼Œè¯·å®‰è£…æœ€æ–°ç‰ˆ opamã€‚

```bash title='Shell Command'
opam --version
```

å®‰è£…æˆåŠŸåéœ€è¦æ‰§è¡Œä¸‹é¢å‘½ä»¤ åˆå§‹åŒ– opam çŠ¶æ€ï¼š

```bash title='Shell Command'
opam init
```

è‡³æ­¤ opam å®‰è£…é…ç½®å®Œæˆã€‚

### ä½¿ç”¨ opam å®‰è£… Coq

æœ¬å°èŠ‚å†…å®¹äº¦å¯è®¿é—®Â :link[å®˜æ–¹å®‰è£…æŒ‡å—]{id=https://coq.inria.fr/opam-using.html}ã€‚ 

é¦–å…ˆç¡®ä¿ opam å®‰è£…æˆåŠŸå¹¶åˆå§‹åŒ–ï¼Œæ¥ä¸‹æ¥å¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤è‡ªåŠ¨å®‰è£…ï¼Œç”±äº Coq éœ€è¦ä»æºç ç¼–è¯‘æ‰€ä»¥å®‰è£…æ—¶é—´è¾ƒé•¿ï¼š

```bash title='Shell Command'
opam pin add coq 8.20.0
```

æ³¨æ„ï¼šCoq æœ€æ–°ç‰ˆæœ¬å¯èƒ½å·²æ›´æ–°ï¼Œå¦‚æœæƒ³æŸ¥çœ‹æœ€è¿‘ç‰ˆæœ¬è¯·è®¿é—® :link[Coqå®˜ç½‘]{id=https://coq.inria.fr/} æˆ–è€…å…¶ :link[githubä»“åº“]{id=https://github.com/coq/coq} 

ä»¥ä¸Šè¿°å‘½ä»¤å®‰è£… Coq ä¸ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œè‹¥æ›´æ–°è¯·æ‰§è¡Œï¼š

```bash title='Shell Command'
opam pin add coq <ç‰ˆæœ¬å·>
```

ä½¿ç”¨ä¸‹é¢å‘½ä»¤å¯ä»¥æŸ¥çœ‹ Coq æ˜¯å¦è¢«æ­£ç¡®å®‰è£…ï¼š

```bash title='Shell Command'
coqc --version
```
<!-- :link[Coqå®˜ç½‘]{id=https://coq.inria.fr/} æˆ–è€…å…¶ :link[githubä»“åº“]{id=https://github.com/coq/coq} -->
### é…ç½® VsCoq
é¦–å…ˆåœ¨ vscode ä¸­å®‰è£…æ‰©å±• VsCoqã€‚æ¥ä¸‹æ¥æŒ‰ç…§ :link[æ’ä»¶è¯´æ˜é¡µ]{id=https://marketplace.visualstudio.com} 
çš„è¯´æ˜ï¼Œä¾æ¬¡è¿è¡Œä¸¤ä¸ªä¸‹è½½å‘½ä»¤ï¼š

```bash title='Shell Command'
opam pin add coq 8.18.0
opam install vscoq-language-server
```

è¿™ä¼šåœ¨ ubuntu ä¸Šå®‰è£… language serverï¼Œæ¥ä¸‹æ¥ä¸ºäº†è®© vscode æ‰¾åˆ°è¿™ä¸ª serverï¼Œä½ éœ€è¦è¿è¡Œ

```bash title='Shell Command'
which vscoqtop
```

> [!caution]
> **æ³¨æ„**
>
> å¦‚æœæ­¤æ—¶æ²¡æœ‰è¾“å‡ºï¼ˆå³å¤±è´¥ï¼‰ï¼Œå¯èƒ½æ˜¯æ²¡æœ‰åˆ·æ–°ã€‚è¿è¡Œ
> ```bash title='Shell Command'
> eval $(opam env)
> ```

æ­¤æ—¶ä½ å°†å¾—åˆ°ä¸€ä¸ªç±»ä¼¼äº
```bash title='Shell Command'
`/home/$USERNAME$/.opam/default/bin/vscoqtop`
```
çš„è¾“å‡ºï¼Œå°†å…¶**å®Œæ•´åœ°å¤åˆ¶ä¸‹æ¥**ï¼Œå¡«å…¥ VsCoq çš„ Extension Setting ä¸­ï¼Œ`VsCoq: Path`Â çš„å€¼ã€‚

>æœ‰äººåœ¨ Windows ä¸‹é…ç¯å¢ƒå˜é‡é…ä¹ æƒ¯äº†ï¼ŒæŠŠè·¯å¾„å¤åˆ¶åˆ°Â `../bin`Â å°±åœäº†ã€‚ä½†æ˜¯æ­¤æ—¶å¿…é¡»è¦å®Œæ•´åœ°å¤åˆ¶å…¨éƒ¨å†…å®¹ã€‚

## COQè¯­æ³•ä»‹ç»

åœ¨æµè§ˆè½¯ä»¶åŸºç¡€è¿™æœ¬ä¹¦æ—¶ï¼Œå‘è§‰å®ƒå¯¹å…¥é—¨è€…çš„ç…§é¡¾å¹¶ä¸æ˜¯ç‰¹åˆ«å‹å¥½ï¼Œå› æ­¤ï¼Œå…³äºCoqçš„è¯­æ³•è§„åˆ™ï¼Œæˆ‘ä½¿ç”¨Cluadeå¤§æ¨¡å‹æ¥è¿›è¡Œä¸€æ­¥æ­¥çš„è®²è§£ã€‚
### 1. åŸºæœ¬å®šä¹‰å’Œå£°æ˜
#### 1.1 å®šä¹‰å¸¸é‡
ä½¿ç”¨ Definition æ¥å®šä¹‰å¸¸é‡æˆ–å‡½æ•°ã€‚
```coq
Definition pi := 3.14.
Check pi.  (* è¾“å‡º: pi : R *)
```
#### 1.2 å®šä¹‰å‡½æ•°
ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®šä¹‰ç®€å•åŠ æ³•å‡½æ•°çš„ä¾‹å­ï¼š
```coq
Definition add (a b : nat) : nat := a + b.
Check add.
(* è¾“å‡º: add : nat -> nat -> nat *)
```
### 2. æ•°æ®ç±»å‹
#### 2.1 è‡ªç„¶æ•°ï¼ˆnatï¼‰
Coq å†…ç½®äº†è‡ªç„¶æ•°ç±»å‹ natï¼Œå¹¶æä¾›äº†ç›¸å…³æ“ä½œã€‚
```coq
Check 0.  (* è¾“å‡º: 0 : nat *)
Check 1.  (* è¾“å‡º: 1 : nat *)
```
#### 2.2 å¸ƒå°”å‹ï¼ˆboolï¼‰
å¸ƒå°”å‹åœ¨ Coq ä¸­ä¹Ÿå¾ˆå¸¸ç”¨ã€‚
```coq
Check true.  (* è¾“å‡º: true : bool *)
Check false. (* è¾“å‡º: false : bool *)
```
#### 3. å½’çº³ç±»å‹
ä½ å¯ä»¥å®šä¹‰è‡ªå·±çš„æ•°æ®ç»“æ„ï¼Œä¾‹å¦‚åˆ—è¡¨ã€‚
```coq
Inductive my_list (A : Type) : Type :=
  | nil : my_list A
  | cons : A -> my_list A -> my_list A.
```
### 4. å‡½æ•°å®šä¹‰ä¸æ¨¡å¼åŒ¹é…
#### 4.1 å®šä¹‰å‡½æ•°
ä½¿ç”¨ Fixpoint å®šä¹‰é€’å½’å‡½æ•°ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªè®¡ç®—åˆ—è¡¨é•¿åº¦çš„ä¾‹å­ï¼š
```coq
Fixpoint my_length {A : Type} (l : my_list A) : nat :=
  match l with
  | nil _ => 0
  | cons _ _ l' => 1 + my_length l'
  end.
  ```
### 5. è¯æ˜ç»“æ„
#### 5.1 å£°æ˜å®šç†
ä½¿ç”¨ Theorem æ¥å£°æ˜ä¸€ä¸ªæ–°çš„å®šç†ã€‚
```coq
Theorem zero_plus : forall n : nat, 0 + n = n.
Proof.
  (* è¯æ˜å°†åœ¨è¿™é‡Œè¿›è¡Œ *)
Qed.
```
#### 5.2 ä½¿ç”¨ç­–ç•¥
ä»¥ä¸‹æ˜¯ä½¿ç”¨ç­–ç•¥è¯æ˜åŠ æ³•çš„æ€§è´¨ï¼š
```coq
Theorem zero_plus : forall n : nat, 0 + n = n.
Proof.
  intro n.      (* å¼•å…¥å˜é‡ n *)
  simpl.       (* ç®€åŒ–è¡¨è¾¾å¼ *)
  reflexivity. (* è¯æ˜ä¸¤è¾¹ç›¸ç­‰ *)
Qed.
```
#### 5.3 å½’çº³æ³•è¯æ˜
å½’çº³æ³•è¯æ˜çš„åŸºæœ¬ç»“æ„å¦‚ä¸‹ï¼š
```coq
Theorem plus_0_r : forall n : nat, n + 0 = n.
Proof.
  intro n.
  (* ä½¿ç”¨å½’çº³æ³• *)
  induction n as [| n' IHn'].
  - simpl. reflexivity.  (* åŸºç¡€æƒ…å†µ *)
  - simpl. rewrite -> IHn'. reflexivity.  (* å½’çº³æ­¥éª¤ *)
Qed.
```
### 6. æ¡ä»¶è¯­å¥å’Œå¾ªç¯
Coq ä½¿ç”¨æ¨¡å¼åŒ¹é…æ¥å®šä¹‰æ¡ä»¶å’Œå¤„ç†é€»è¾‘ã€‚
```coq
Definition is_zero (n : nat) : bool :=
  match n with
  | 0 => true
  | _ => false
  end.
  ```
### 7. é€»è¾‘è¿ç®—
Coq æä¾›äº†åŸºæœ¬çš„é€»è¾‘è¿ç®—ï¼Œä¾‹å¦‚ä¸ï¼ˆandï¼‰ã€æˆ–ï¼ˆorï¼‰ã€éï¼ˆnotï¼‰ã€‚

#### 7.1 é€»è¾‘ä¸
```coq
Definition and_example (p q : Prop) : Prop := p /\ q.
```
#### 7.2 é€»è¾‘æˆ–
```coq
Definition or_example (p q : Prop) : Prop := p \/ q.
```
#### 7.3 é€»è¾‘é

```coq
Definition not_example (p : Prop) : Prop := ~p.
```
### 8. å˜é‡å’Œç±»å‹
#### 8.1 ç±»å‹å£°æ˜
ä½ å¯ä»¥å£°æ˜å˜é‡å’Œå…¶ç±»å‹ï¼š

```coq
Definition x : nat := 5.
Check x.  (* è¾“å‡º: x : nat *)
```
#### 9. æ³¨é‡Š
Coq å…è®¸ä½¿ç”¨ (* ... *) è¿›è¡Œæ³¨é‡Šï¼š

> (* è¿™æ˜¯ä¸€ä¸ªæ³¨é‡Š *)

### ä¸€å‘¨ä¸ƒæ—¥

#### å®šä¹‰ç±»å‹

```js title='one.v' collapse={1-10, 20-31} showLineNumbers
(*
è¿™æ®µCoqä»£ç å®šä¹‰äº†ä¸€ä¸ªæ–°çš„å½’çº³ç±»å‹ï¼ˆInductive Typeï¼‰ï¼Œåä¸º dayã€‚
å¯ä»¥è¿™æ ·ç†è§£ï¼š
Inductive day : Type: è¿™éƒ¨åˆ†å£°æ˜äº†æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªåä¸º day çš„æ–°ç±»å‹ã€‚Inductive å…³é”®å­—è¡¨ç¤ºè¿™ä¸ªç±»å‹æ˜¯é€šè¿‡åˆ—ä¸¾å…¶æ‰€æœ‰å¯èƒ½çš„æ„é€ å‡½æ•°ï¼ˆconstructorï¼‰æ¥å®šä¹‰çš„ã€‚: Type è¡¨ç¤º day æœ¬èº«æ˜¯ä¸€ä¸ªç±»å‹ã€‚
:=: è¿™æ˜¯å®šä¹‰æ“ä½œç¬¦ï¼Œæ„æ€æ˜¯â€œè¢«å®šä¹‰ä¸ºâ€ã€‚
| monday | tuesday ... | sunday: è¿™ä¸€é•¿ä¸²ç”± | åˆ†éš”çš„åˆ—è¡¨æ˜¯ day ç±»å‹çš„æ„é€ å‡½æ•°ã€‚æ¯ä¸€ä¸ªæ„é€ å‡½æ•°éƒ½æ˜¯ day ç±»å‹çš„ä¸€ä¸ªå”¯ä¸€ã€ç¦»æ•£çš„å€¼ã€‚
ç®€å•æ¥è¯´ï¼Œè¿™æ®µä»£ç æ˜¯åœ¨åˆ›å»ºä¸€ä¸ªæšä¸¾ç±»å‹ï¼Œå°±åƒåœ¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­ä¸€æ ·ã€‚ å®ƒåˆ›å»ºäº†ä¸€ä¸ªåä¸º day çš„æ–°ç±»å‹ï¼Œè¿™ä¸ªç±»å‹çš„å˜é‡åªèƒ½å– monday, tuesday, wednesday, thursday, friday, saturday, sunday è¿™ä¸ƒä¸ªå€¼ä¸­çš„ä¸€ä¸ªã€‚
*)


Inductive day : Type :=
| monday 
| tuesday 
| wednesday 
| thursday 
| friday 
| saturday 
| sunday.

(*
match d with ... end:

è¿™æ˜¯ä¸€ä¸ªæ¨¡å¼åŒ¹é…è¡¨è¾¾å¼ï¼Œæ˜¯Coqï¼ˆä»¥åŠè®¸å¤šå‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ï¼‰ä¸­éå¸¸æ ¸å¿ƒå’Œå¼ºå¤§çš„åŠŸèƒ½ã€‚
å®ƒçš„ä½œç”¨æ˜¯æ£€æŸ¥å˜é‡ d çš„å…·ä½“å€¼ï¼Œå¹¶æ ¹æ®ä¸åŒçš„å€¼æ‰§è¡Œä¸åŒçš„ä»£ç åˆ†æ”¯ã€‚
ä½ å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯å…¶ä»–è¯­è¨€ä¸­ switch-case è¯­å¥çš„æ›´å¼ºå¤§ç‰ˆæœ¬ã€‚
| monday => tuesday:

è¿™æ˜¯ä¸€ä¸ªåŒ¹é…åˆ†æ”¯ã€‚| åˆ†éš”äº†ä¸åŒçš„æƒ…å†µã€‚
å®ƒè¡¨ç¤ºï¼šâ€œå¦‚æœ d çš„å€¼æ˜¯ mondayï¼Œ
é‚£ä¹ˆ => æ•´ä¸ªè¡¨è¾¾å¼çš„ç»“æœå°±æ˜¯ tuesdayâ€ã€‚
*)
Definition next_weekday (d : day) : day :=
match d with
| monday => tuesday
| tuesday => wednesday 
| wednesday => thursday 
| thursday => friday 
| friday => monday 
| saturday => monday 
| sunday => monday 
end.

(* æµ‹è¯•ï¼šè®¡ç®— next_weekday friday çš„ç»“æœï¼ˆåº”è¿”å› mondayï¼‰ *)
Compute (next_weekday friday).  (* è¾“å‡ºï¼šmonday : day *)

(* 
   å®šä¹‰ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹å‘½é¢˜ï¼š
   "è¿ç»­ä¸¤æ¬¡å¯¹ saturday è°ƒç”¨ next_weekday çš„ç»“æœåº”ç­‰äº tuesday"
   è§£é‡Šï¼š
   1. ç¬¬ä¸€æ¬¡ next_weekday saturday â†’ monday
   2. ç¬¬äºŒæ¬¡ next_weekday monday â†’ tuesday
*)
Example test_next_weekday:
  (next_weekday (next_weekday saturday)) = tuesday.

(* è¯æ˜è¿‡ç¨‹ï¼š
   - simplï¼šåŒ–ç®€è¡¨è¾¾å¼ï¼ˆè®¡ç®—å…·ä½“å€¼ï¼‰
   - reflexivityï¼šæ£€æŸ¥ç­‰å¼ä¸¤è¾¹æ˜¯å¦ç›¸åŒ
   - Qedï¼šå®Œæˆè¯æ˜
*)
Proof. 
  simpl.       (* å±•å¼€è®¡ç®—ï¼šnext_weekday saturday â†’ monday 
                       ç„¶å next_weekday monday â†’ tuesday *)
  reflexivity. (* éªŒè¯ tuesday = tuesday *)
Qed.

(* æ£€æŸ¥ test_next_weekday çš„ç±»å‹ï¼Œç¡®è®¤å®ƒæ˜¯ä¸€ä¸ªå·²è¢«è¯æ˜çš„å‘½é¢˜ *)
Check test_next_weekday.  (* è¾“å‡ºï¼štest_next_weekday : ... = tuesday *)
```
å¦‚ä¸Šæ‰€è¿°ï¼Œæœ‰äº†ä¸Šé¢è¿™ä¸ªä¾‹å­ï¼Œä¹‹åçš„ä¸€äº›å†…å®¹å°±å¯ä»¥çœ‹æ‡‚äº†ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ã€‚

#### ç»ƒä¹ (âœ¨) standard (nandb)

```coq title="nandb.v"
Definition nandb (b1:bool) (b2:bool) : bool :=
(*ä¸€å¼€å§‹ä¸çŸ¥é“matchå¯ä»¥åŒ¹é…ä¸¤ä¸ªå‚æ•°*)
  match b1, b2 with
  | true, true => false
  | _, _       => true
  end.

Example test_nandb1: (nandb true false) = true.
Proof. reflexivity. Qed.

Example test_nandb2: (nandb false false) = true.
Proof. reflexivity. Qed.

Example test_nandb3: (nandb false true) = true.
Proof. reflexivity. Qed.

Example test_nandb4: (nandb true true) = false.
Proof. reflexivity. Qed.
```
> [!caution] simpl å’Œ reflexivity çš„ç®€æ˜æ€»ç»“
> ```markdown
># Coq ä¸­çš„ `simpl` å’Œ `reflexivity` æ€»ç»“
>
>## 1. ä¸ºä»€ä¹ˆä¾‹å­ä¸åŠ  `simpl` ä¹Ÿèƒ½é€šè¿‡ï¼Ÿ
> - `reflexivity` ä¼šè‡ªåŠ¨è¿›è¡Œéšå¼è®¡ç®—
> - èƒ½ç›´æ¥å¤„ç†åƒ `nandb` è¿™æ ·çš„é€æ˜å®šä¹‰
> - è‡ªåŠ¨éªŒè¯åŒ–ç®€åçš„ç­‰å¼ï¼ˆå¦‚ `true = true`ï¼‰
>
> ## 2. `simpl` çš„ä½œç”¨
> | åŠŸèƒ½ | è¯´æ˜ |
> |------|------|
> | æ˜¾å¼åŒ–ç®€ | å±•å¼€å‡½æ•°å®šä¹‰ã€è®¡ç®— match åˆ†æ”¯ |
> | è°ƒè¯•ç”¨é€” | è§‚å¯Ÿä¸­é—´è®¡ç®—æ­¥éª¤ |
> | å¤æ‚è¡¨è¾¾å¼ | éœ€è¦åˆ†æ­¥è®¡ç®—æ—¶ä½¿ç”¨ |
>
> ## 3. ç­–ç•¥å¯¹æ¯”
> | ç­–ç•¥ | åŠŸèƒ½ | è‡ªåŠ¨è®¡ç®— |
> |------|------|---------|
> | `reflexivity` | æ£€æŸ¥ç­‰å¼ä¸€è‡´æ€§ | æ˜¯ |
> | `simpl` | ä»…è¿›è¡Œè¡¨è¾¾å¼åŒ–ç®€ | å¦ |
>
> ## 4. å¿…é¡»ä½¿ç”¨ `simpl` çš„æƒ…å†µ
> ```coq
> Example: (1 + 1) + (1 + 1) = 4.
> Proof.
>  simpl.      (* å¿…é¡»æ˜¾å¼åŒ–ç®€ *)
>  reflexivity.
> Qed.
> 
> ```
#### ç»ƒä¹ (âœ¨) standard (andb3)

```coq title="and3.v"
Definition andb3 (b1:bool) (b2:bool) (b3:bool) : bool :=  
match b1,b2,b3 with
| true,true,true => true
| _,_,_ => false
end.

Example test_andb31: (andb3 true true true) = true. 
Proof. simpl. reflexivity. Qed. 
Example test_andb32: (andb3 false true true) = false. 
Proof. simpl. reflexivity. Qed.
Example test_andb33: (andb3 true false true) = false. 
Proof. simpl. reflexivity. Qed.
Example test_andb34: (andb3 true true false) = false. 
Proof. simpl. reflexivity. Qed. 
```
#### ç»ƒä¹ (âœ¨) standard (factorial)

```coq title="factorial.v"
Require Import Coq.Arith.Arith. 

Fixpoint plus (n m : nat) : nat :=
  match n with
  | O => m
  | S n' => S (plus n' m)
  end.

Module NatPlayground2.
Fixpoint mult (n m : nat) : nat := 
  match n with
  | O => O
  | S n' => plus m (mult n' m)  (* æ­£ç¡®çš„é€’å½’ä¹˜æ³• *)
  end.
Example test_mult1: (mult 3 3) = 9. 
Proof. simpl. reflexivity. Qed.

Fixpoint factorial ( n : nat) : nat := 
match n with
 | O => 1
 | S n' => mult n (factorial n')
 end.
Example test_factorial1: (factorial 3) = 6. 
Proof. simpl. reflexivity. Qed. 
Example test_factorial2: (factorial 5) = (mult 10 12). 
Proof. simpl. reflexivity. Qed.
```
#### ç»ƒä¹ (âœ¨) standard (ltb)
```coq title="ltb.v"
(* å¯¼å…¥æ ‡å‡†åº“ï¼ˆç¡®ä¿ eqb å’Œ leb å·²å®šä¹‰ï¼‰ *)
Require Import Coq.Arith.Arith.

(* æ–¹æ¡ˆ1ï¼šç›´æ¥æ¨¡å¼åŒ¹é… leb å’Œ eqb çš„ç»“æœ *)
Definition ltb_v1 (n m : nat) : bool :=
  match (n <=? m), (n =? m) with
  | true, false => true   (* n â‰¤ m ä¸” n â‰  m æ—¶è¿”å› true *)
  | _, _        => false  (* å…¶ä»–æƒ…å†µè¿”å› false *)
  end.

(* æ–¹æ¡ˆ2ï¼šåµŒå¥— if è¡¨è¾¾å¼ *)
Definition ltb_v2 (n m : nat) : bool :=
  if (n <=? m) then       (* å…ˆæ£€æŸ¥ n â‰¤ m *)
    if (n =? m) then      (* å†æ£€æŸ¥æ˜¯å¦ä¸ç­‰äº *)
      false               (* n = m æ—¶è¿”å› false *)
    else true             (* n < m æ—¶è¿”å› true *)
  else false.             (* n > m æ—¶è¿”å› false *)

(* æ–¹æ¡ˆ3ï¼šç‹¬ç«‹é€’å½’å®ç°ï¼ˆä¸ä¾èµ– leb/eqbï¼‰ *)
Fixpoint ltb_v3 (n m : nat) : bool :=
  match n, m with
  | O,   S _  => true     (* 0 < ä»»ä½•æ­£æ•° *)
  | S n', S m' => ltb_v3 n' m'  (* é€’å½’æ¯”è¾ƒå‰é©± *)
  | _,    _    => false   (* å…¶ä»–æƒ…å†µï¼ˆåŒ…æ‹¬ n=O,m=O å’Œ n>S _,m=Oï¼‰ *)
  end.

(* æ–¹æ¡ˆ4ï¼šåˆ©ç”¨ leb çš„å¦å®šï¼ˆæœ€ç®€æ´æ•°å­¦å®šä¹‰ï¼‰ *)
Definition ltb_v4 (n m : nat) : bool :=
  negb (m <=? n).  (* n < m å½“ä¸”ä»…å½“ Â¬(m â‰¤ n) *)

(* ä¸ºæ‰€æœ‰æ–¹æ¡ˆå£°æ˜ç»Ÿä¸€çš„ä¸­ç¼€è®°æ³• *)
Notation "x <? y" := (ltb_v1 x y) (at level 70).  (* å¯æ›¿æ¢ä¸º v2/v3/v4 *)

(* ===================== æµ‹è¯•ç”¨ä¾‹ ===================== *)
Section Tests.
(* æµ‹è¯•ç”¨ä¾‹éªŒè¯æ‰€æœ‰æ–¹æ¡ˆç­‰ä»· *)
Example test_all1: ltb_v1 2 2 = false /\ ltb_v2 2 2 = false /\
                 ltb_v3 2 2 = false /\ ltb_v4 2 2 = false.
Proof. simpl; auto. Qed.

Example test_all2: ltb_v1 2 4 = true /\ ltb_v2 2 4 = true /\
                 ltb_v3 2 4 = true /\ ltb_v4 2 4 = true.
Proof. simpl; auto. Qed.

Example test_all3: ltb_v1 4 2 = false /\ ltb_v2 4 2 = false /\
                 ltb_v3 4 2 = false /\ ltb_v4 4 2 = false.
Proof. simpl; auto. Qed.

(* è¾¹ç•Œæµ‹è¯•ï¼š0 çš„æ¯”è¾ƒ *)
Example test_zero: ltb_v1 0 0 = false /\ ltb_v3 0 1 = true.
Proof. simpl; auto. Qed.
End Tests.

(* æ–¹æ¡ˆé€‰æ‹©å»ºè®® *)
(*
1. éœ€è¦æ¸…æ™°é€»è¾‘ï¼šé€‰æ‹© v1 æˆ– v2
2. éœ€è¦ç‹¬ç«‹å®ç°ï¼šé€‰æ‹© v3
3. éœ€è¦æ•°å­¦ç®€æ´æ€§ï¼šé€‰æ‹© v4
4. å®é™…å¼€å‘æ¨èç›´æ¥ä½¿ç”¨æ ‡å‡†åº“çš„ Nat.ltb
*) 
```

| æŒ‡ä»¤      | ç”¨é€”               | æ­£å¼æ€§   | æ˜¯å¦å¯åç»­å¼•ç”¨ |
|-----------|--------------------|----------|----------------|
| `Example` | æµ‹è¯•ç”¨ä¾‹           | éæ­£å¼   | å¦             |
| `Lemma`   | è¾…åŠ©å¼•ç†           | æ­£å¼     | æ˜¯             |
| `Theorem` | é‡è¦ç»“è®º           | æœ€æ­£å¼   | æ˜¯             |

### Coq ç­–ç•¥ `reflexivity` ä¸ `simpl` å¯¹æ¯”æ–‡æ¡£

#### æ ¸å¿ƒå·®å¼‚å¯¹æ¯”

| ç­–ç•¥          | åŒ–ç®€è¡Œä¸º                                   | è®¾è®¡ç›®çš„                     |
|---------------|-------------------------------------------|----------------------------|
| `reflexivity` | è‡ªåŠ¨å±•å¼€æ‰€æœ‰å®šä¹‰ï¼Œç›´åˆ°ç­‰å¼ä¸¤è¾¹å®Œå…¨ä¸€è‡´æˆ–æ— æ³•åŒ–ç®€ | å¿«é€ŸéªŒè¯ç­‰å¼æˆç«‹ï¼ˆä¸å…³å¿ƒä¸­é—´æ­¥éª¤ï¼‰ |
| `simpl`       | ä»…è¿›è¡Œå•æ­¥åŒ–ç®€ï¼Œä¿ç•™ç”¨æˆ·å¯è¯»çš„ä¸­é—´å½¢å¼         | è°ƒè¯•å’Œè§‚å¯ŸåŒ–ç®€è¿‡ç¨‹            |

#### ç¤ºä¾‹å°è¯

```coq
Definition double n := n + n.

Lemma demo_diff : double 2 = 4.
Proof.
  (* ä½¿ç”¨ simpl æ—¶ï¼š *)
  simpl.   (* ç›®æ ‡å˜ä¸º 2 + 2 = 4ï¼Œä¿ç•™å¯è¯»å½¢å¼ *)

  (* ä½¿ç”¨ reflexivity æ—¶ï¼š *)
  reflexivity.  (* ç›´æ¥å±•å¼€æ‰€æœ‰å®šä¹‰å®Œæˆè¯æ˜ï¼Œä¸æ˜¾ç¤ºä¸­é—´çŠ¶æ€ *)
Qed.
```
**ä½¿ç”¨å»ºè®®**

- ä¼˜å…ˆä½¿ç”¨ reflexivityï¼š
å½“ç­‰å¼æ˜¾ç„¶æˆç«‹æ—¶ï¼ˆå¦‚ç®—æœ¯è¿ç®—ï¼‰
å¸Œæœ›è‡ªåŠ¨å¤„ç†æ‰€æœ‰å±•å¼€æ—¶

- ä¼˜å…ˆä½¿ç”¨ simplï¼š
éœ€è¦è§‚å¯Ÿä¸­é—´åŒ–ç®€çŠ¶æ€æ—¶
é¿å…è¿‡åº¦å±•å¼€å¯¼è‡´è¡¨è¾¾å¼æ··ä¹±

#### ç»ƒä¹ (âœ¨) standard (plus_id_exercise)

```coq
Theorem plus_id_exercise : forall n m o : nat,
  n = m â†’ m = o â†’ n + m = m + o.
Proof.
  (* å¼•å…¥æ‰€æœ‰å‰æ *)
  intros n m o H1 H2.  
  (* H1 : n = m
     H2 : m = o
     ç›®æ ‡ï¼šn + m = m + o *)
  
  (* å…ˆç”¨ H1 å°†ç›®æ ‡ä¸­çš„ n æ›¿æ¢ä¸º m *)
  rewrite -> H1.  
  (* æ–°ç›®æ ‡ï¼šm + m = m + o *)
  
  (* å†ç”¨ H2 å°†ç›®æ ‡ä¸­çš„ m æ›¿æ¢ä¸º o *)
  rewrite -> H2.  
  (* æ–°ç›®æ ‡ï¼šo + o = o + o *)
  
  (* ä¸¤è¾¹å·²å®Œå…¨ç›¸åŒ *)
  reflexivity.
Qed.
```
ä½†æ˜¯ï¼Œæ­¤æ—¶å­˜åœ¨ç–‘é—®ğŸ¤”ï¼Ÿä¸ºä»€ä¹ˆå‡å®šH1å°±ä»£è¡¨äº†n=må‘¢ï¼Ÿè¿™æ˜¯COQçš„è§„å®šå—ï¼Ÿæˆ–è€…è¯´æˆ‘æ¼æ‰äº†ä»€ä¹ˆä¸œè¥¿ï¼Ÿ
ç»æŸ¥é˜…ï¼Œæœ‰ä»¥ä¸‹ç»“è®ºï¼š
`åœ¨ Coq ä¸­ï¼ŒH1 ä»£è¡¨ n = m æ˜¯ç”± intros ç­–ç•¥çš„è¯­æ³•è§„åˆ™å’Œé€»è¾‘ç»“æ„å†³å®šçš„ï¼Œè¿™æ˜¯ Coq çš„åŸºæœ¬è®¾è®¡çº¦å®šï¼Œä½†å¹¶ééšæ„è§„å®šï¼Œè€Œæ˜¯åŸºäºé€»è¾‘æ¨ç†çš„è‡ªç„¶å½¢å¼åŒ–ã€‚`

> [!tip] æ€»ç»“
> 1. intros ç­–ç•¥çš„å·¥ä½œæœºåˆ¶
> å½“è¯æ˜ä¸€ä¸ªå½¢å¦‚ âˆ€ n m, n = m â†’ m = o â†’ ... çš„å®šç†æ—¶ï¼š
> intros n m o H1 H2 çš„æ‰§è¡Œè¿‡ç¨‹ï¼š
> æŒ‰é¡ºåºå¼•å…¥ âˆ€ é‡è¯å˜é‡ï¼šn, m, o
> æŒ‰é¡ºåºå¼•å…¥ â†’ çš„å‰æï¼š
> ç¬¬ä¸€ä¸ªå‰æ n = m è¢«å‘½åä¸º H1
> ç¬¬äºŒä¸ªå‰æ m = o è¢«å‘½åä¸º H2
> è‡ªåŠ¨å‘½åè§„åˆ™ï¼š
> è‹¥ç”¨æˆ·ä¸æ˜¾å¼æŒ‡å®šåç§°ï¼ˆå¦‚ intros n m o Hfoo Hbarï¼‰ï¼ŒCoq ä¼šæŒ‰ H, H0, H1... è‡ªåŠ¨ç”Ÿæˆåç§°
> åç§°æœ¬èº«å¯è‡ªå®šä¹‰ï¼Œä½†ä½ç½®é¡ºåºå¿…é¡»å¯¹åº”å‰æçš„é¡ºåº
> 
> 2. ä¸ºä»€ä¹ˆ H1 å¯¹åº” n = mï¼Ÿ
> è¿™æ˜¯ç”±å®šç†çš„é€»è¾‘ç»“æ„é¡ºåºå†³å®šçš„ï¼š
> ```coq
> Theorem plus_id_exercise : âˆ€ n m o, 
>   n = m â†’    (* ç¬¬ä¸€ä¸ªå‰æ *)
>   m = o â†’    (* ç¬¬äºŒä¸ªå‰æ *)
>   n + m = m + o.
> ```
>
> intros ä»å·¦åˆ°å³ä¾æ¬¡å¤„ç†ï¼š
> å…ˆå¤„ç† n = mï¼Œå‘½åä¸º H1,
> å†å¤„ç† m = oï¼Œå‘½åä¸º H2
> 
> 3. åº•å±‚é€»è¾‘ä¾æ®
> åœ¨ç±»å‹è®ºä¸­ï¼Œâ†’ å¯¹åº”å‡½æ•°ç±»å‹ï¼š
> A â†’ B å¯ç†è§£ä¸ºâ€œç»™å®šä¸€ä¸ª A ç±»å‹çš„å€¼ï¼Œå¯å¾—åˆ° B ç±»å‹çš„å€¼â€
> åœ¨è¯æ˜ä¸­ï¼Œintros H ç›¸å½“äºï¼š
> å‡è®¾ä½ å·²æœ‰ä¸€ä¸ª A çš„è¯æ˜ï¼ˆå³å‰æ H : Aï¼‰
> ç›®æ ‡æ˜¯æ„é€  B çš„è¯æ˜
> 
> 4. ç”¨æˆ·è‡ªå®šä¹‰ç¤ºä¾‹
> ä½ å¯ä»¥è‡ªç”±é‡å‘½åå‰æï¼Œä½†é¡ºåºä¸å˜ï¼š
> ```coq
> Theorem plus_id_exercise : âˆ€ n m o, 
>   n = m â†’ m = o â†’ n + m = m + o.
> Proof.
>   intros x y z Eq_nm Eq_mo.  (* è‡ªå®šä¹‰åç§° *)
>   rewrite -> Eq_nm, -> Eq_mo. (* ä½¿ç”¨æ–°åç§° *)
>   reflexivity.
> Qed.
> ```
>
> Eq_nm ä»å¯¹åº”ç¬¬ä¸€ä¸ªå‰æ n = mï¼ˆå³ x = yï¼‰
> Eq_mo ä»å¯¹åº”ç¬¬äºŒä¸ªå‰æ m = oï¼ˆå³ y = zï¼‰


#### ç»ƒä¹ (âœ¨âœ¨) standard (andb_true_elim2)
```coq title="andb_true_elim2.v"
Theorem andb_true_elim2 : forall b c : bool, 
andb b c = true -> c = true. 
Proof.
  intros b c H.              (* å¼•å…¥å‡è®¾ H: andb b c = true *)
  destruct b eqn:Eb.         (* åˆ†æƒ…å†µè®¨è®ºb *)
  - (* b = true *)
    simpl in H.              (* Hå˜ä¸º c = true *)
    apply H.                 (* ç›´æ¥ä½¿ç”¨å‡è®¾ *)
  - (* b = false *)
    simpl in H.              (* Hå˜ä¸º false = true *)
    discriminate H.          (* æ’é™¤ä¸å¯èƒ½æƒ…å†µ *)
Qed.
```
å½“ç„¶ï¼Œä½¿ç”¨`rewrite`ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä»¥ä¸‹æ˜¯rewriteç‰ˆæœ¬ï¼š
```coq title="version-2.0"
Theorem andb_true_elim2 : âˆ€ b c, andb b c = true â†’ c = true.
Proof.
  intros b c H.
  destruct b eqn:Eb.
  - (* b = true *)
    simpl in H.      (* H : c = true *)
    rewrite H.       (* ç›®æ ‡ä» c=true å˜ä¸º true=true *)
    reflexivity.     (* éªŒè¯ *)
  - (* b = false *)
    simpl in H.      (* H : false = true *)
    discriminate H.
Qed.
```

| ç‰¹æ€§                | `apply`                          | `rewrite`                        |
|---------------------|----------------------------------|----------------------------------|
| **æ ¸å¿ƒä½œç”¨**         | å°†å‡è®¾/å®šç†çš„ç»“è®ºåŒ¹é…å½“å‰ç›®æ ‡      | æŒ‰ç­‰å¼æ›¿æ¢è¡¨è¾¾å¼ä¸­çš„éƒ¨åˆ†          |
| **åº•å±‚é€»è¾‘**         | åå‘æ¨ç†ï¼ˆä»ç»“è®ºåæ¨å‰æï¼‰         | ç¬¦å·é‡å†™ï¼ˆè¡¨è¾¾å¼è½¬æ¢ï¼‰            |
| **å…¸å‹ä½¿ç”¨åœºæ™¯**     | å‡è®¾ä¸ç›®æ ‡å®Œå…¨ä¸€è‡´æ—¶               | éœ€è¦ä¿®æ”¹ç›®æ ‡æˆ–å‡è®¾ä¸­çš„å­è¡¨è¾¾å¼æ—¶   |
| **æ˜¯å¦éœ€è¦é¢å¤–æ­¥éª¤** | ç›´æ¥å®Œæˆè¯æ˜                       | é€šå¸¸éœ€è¦é…åˆ `reflexivity`        |
| **è¯­æ³•ç¤ºä¾‹**         | `apply H.` ï¼ˆH: A â†’ Bï¼Œç›®æ ‡ä¸ºBï¼‰  | `rewrite H.` ï¼ˆH: x = yï¼‰         |
| **æ‰§è¡Œç»“æœ**         | ç”¨å‡è®¾ç›´æ¥é—­åˆç›®æ ‡                 | æ›¿æ¢åå¯èƒ½ä»éœ€éªŒè¯                |
| **ç±»æ¯”æ•°å­¦è¯æ˜**     | "æ ¹æ®å®šç†Tï¼Œç»“è®ºæˆç«‹"              | "å°†å¼å­ä¸­çš„xæ›¿æ¢ä¸ºy"              |


**ç»ˆæé€‰æ‹©æŒ‡å—**

èƒ½ç”¨ `apply` æ—¶ä¼˜å…ˆç”¨ â€”â€” å½“å‡è®¾ä¸ç›®æ ‡å½¢çŠ¶å®Œå…¨åŒ¹é…

å¿…é¡»ç”¨ `rewrite` æ—¶ â€”â€” å½“éœ€è¦è¡¨è¾¾å¼è½¬æ¢æˆ–éƒ¨åˆ†æ›¿æ¢

å¤æ‚åœºæ™¯ç»„åˆç”¨ â€”â€” ä¾‹å¦‚å…ˆ `rewrite` ä¿®æ”¹ç›®æ ‡ï¼Œå† `apply` åŒ¹é…å®šç†